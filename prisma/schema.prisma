generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["views"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model tb_satuan {
  id   Int    @id @default(autoincrement())
  nama String @unique @db.VarChar(10)

  barang tb_barang[]
}

model tb_barang {
  id        Int    @id @default(autoincrement())
  kode      String @unique @db.VarChar(20)
  nama      String @db.VarChar(100)
  harga     Int
  foto      String @db.VarChar(50)
  id_satuan Int

  satuan tb_satuan @relation(fields: [id_satuan], references: [id], onDelete: Cascade)

  penjualan tb_penjualan[]
}

model tb_penjualan {
  id        Int      @id @default(autoincrement())
  kode      String   @db.Char(20)
  tanggal   DateTime
  jumlah    Int
  harga     Int
  id_barang Int

  barang tb_barang @relation(fields: [id_barang], references: [id], onDelete: Cascade)
}

view vw_barang {
  id          Int
  kode        String @db.VarChar(20)
  nama        String @db.VarChar(100)
  harga       Int
  foto        String @db.VarChar(50)
  id_satuan   Int
  nama_satuan String @db.VarChar(10)

  @@map("vw_barang")
}

view vw_penjualan {
  id          Int
  kode        String   @db.Char(20)
  tanggal     DateTime
  jumlah      Int
  harga       Int
  id_barang   Int
  kode_barang String   @db.VarChar(20)
  nama_barang String   @db.VarChar(100)
  id_satuan   Int
  nama_satuan String   @db.VarChar(10)

  @@map("vw_penjualan")
}

view vw_penjualan_group {
  kode    String   @db.Char(20)
  tanggal DateTime @db.Timestamp(6)
  item    Int
  total   Int

  @@map("vw_penjualan_group")
}
